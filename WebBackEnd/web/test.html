<!DOCTYPE html>
<html>
<head>
    <title>Test</title>
    <link href="css/bootstrap.css" rel='stylesheet' type='text/css'/>

    <script src="js/jquery.min.js"></script>
    <script src="js/helpFunction.js"></script>

    <link href="css/hover.css" rel="stylesheet" media="all">
    <link href="css/style.css" rel="stylesheet" type="text/css" media="all"/>


    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link href='http://fonts.useso.com/css?family=Lato:100,300,400,700,900' rel='stylesheet' type='text/css'>

</head>

<body>
<div class="testUser">
    <button onclick="testLogin();"> testLogin</button>

    <button onclick="testReg();"> testReg</button>
</div>

<div class="testLogic">
    <button onclick="testCreateOrder();"> testCreateOrder</button>
    <button onclick="testDoTrade();"> testDoTrade</button>
</div>

<div>
    <button onclick="testQueryProductList();"> testQueryProductList</button>
</div>

</body>

<script>
    //------------------------------------ 用户操作 -----------------------------
    function testLogin()
    {
        ajax("User", "get", {
            action: "login",
            username: "admin",
            password: "admin"
        })
    }

    function testReg()
    {
        //登陆时候的两个密码是否相同的检查在前端做，传给后端的话直接一个json对象就好
        ajax("User","get", {
            action : "register",
            userData : JSON.stringify({
                username : "tempuser",
                company : "M",          //用户公司名，显示用的
                password : "temppwd",
                role : "BROKER"       //用户职能，只能注册为BROKER或者是TRADER，默认是BROKER
            })
        });
    }

    //-------------------------------------业务逻辑------------------------------


    function testCreateOrder()
    {
        ajax("Logic","post", {
            action : "createOrder",
            orderData : JSON.stringify({
                productId: 1,
                userId: 4,          //订单发起人id
                brokerId: 2,       //中介id
                isSell:true,      //买还是卖
                status: "TODO",   //需要执行
                type: "MARKET",   //订单类型，三种：MARKET，LIMIT(优于当前市场价时购买/交易)，STOP(优于用户指定价时购买/交易)
                condition: ">=1124",  //针对LIMIT和STOP订单的触发条件
                expectedVol: 100, //预期交易量
                price: 100.5 ,  //交易单价

            })
        })
    }

    function testCancelOrder()
    {
        ajax("Logic","")
    }

    function testDoTrade()
    {
        ajax("Logic","post", {
            action : "doTrade"
        })
    }

    //---------------------------------------------查询操作-------------------------
    // 查询操作为了方便筛选，提供一个filter参数，key就是属性名，值是要求。比如 kind:"Energy"就是找出所有类型是kind的productlist。
    // 对于product，会多一个市场价的属性。

    function testQueryProductList()
    {
        ajax("Query","get",{
            action: "productList",
            filter: JSON.stringify({    //查询操作的filter都是一个筛选器，一般属性必须和filter里的参数一模一样的才能获得
                kind : "Energy",
                //id: 2               //查询之后，对于整数型参数，也可以为字符串型，我写了处理，后台能够自动把字符串转成整数。

            })
        })
    }

    
    //不打算让用户输入具体的product名，会有出现大小写冲突的情况。
    //broker也是选择的

</script>